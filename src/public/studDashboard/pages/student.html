<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Exam</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    #exam-section { display: none; }
  </style>
</head>
<body>

  <h2>üìö Available Exams</h2>
  <select id="examSelect">
    <option value="">-- Select Exam --</option>
    <option value="exam1">Math Test</option>
    <option value="exam2">Physics Quiz</option>
  </select>
  <button id="startBtn">Start Exam</button>

  <div id="exam-section">
    <h2 id="examTitle"></h2>
    <p>Question 1: What is 2 + 2?</p>
    <ul>
      <li><input type="radio" name="q1"> 3</li>
      <li><input type="radio" name="q1"> 4</li>
      <li><input type="radio" name="q1"> 5</li>
    </ul>
  </div>

  <script>
    let switchCount = 0;
    let examStarted = false;

    document.getElementById('startBtn').onclick = async () => {
      const exam = document.getElementById('examSelect').value;
      if (!exam) return alert("Select an exam to start");

      examStarted = true;
      document.getElementById('examTitle').innerText = "Started: " + exam;
      document.getElementById('exam-section').style.display = 'block';

      // Fullscreen
      const elem = document.documentElement;
      if (elem.requestFullscreen) await elem.requestFullscreen();

      // Start camera backend via Python separately
      fetch('http://localhost:5000/start-camera');

      // Tab switch monitor
      document.addEventListener("visibilitychange", () => {
        if (document.hidden && examStarted) {
          switchCount++;
          if (switchCount === 1) {
            alert("‚ö† Warning: Tab switching detected! One more switch will end your exam.");
          } else {
            alert("‚ùå Exam Terminated due to tab switching.");
            location.href = 'terminated.html'; // or handle logic
          }
        }
      });
    };
  </script>
</body>
</html>
